<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-light-blue.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <title>Clickable Slot Location Selection Mockup</title>
  </head>

  <body>
    <div style="margin:auto;width:80%;">
        <h1>Clickable Slot Location Selection Mockup</h1>
        <p>How the manual location selection / relation creation process could look like, for Modules (child) within a DU (parent). After loading, for DUs (child) within a Detector (parent).</p>
        <p><em><span style="color:red;">Preliminary user action for this mockup:</span></em> Before using the form below, upload a slot table csv on the bottom of the page. This will be used to find the slot relations later.</p>
        <p>Modeled after the /addpartstree page of the official ProdDB, you can try various DUs here and select the respective modules by clicking them.</p>
        <p>Each SU is oriented in such a way that when looking at its face, the module connectors are at the top (or on the right), and module capacitors are on the bottom (or on the left).</p>
        <p><em><span style="color:red;">User actions (loading sites / assembly at CERN):</span></em> First step at a loading site: fill the DU with modules, click on the canvas to select the correct position and use the button below. Once finished, move to the assembly step at CERN and enter the position manually when connecting a DU with the Detector (VxLxQx). Note: A back DU can only be on layer 1 or 2, a front DU can only be on layer 0 or 3.</p>
        <p>If you did everything correctly, you can see the correct slots per loaded module and from those, see the suitable flex tail categories.</p>
        <div id="content">
            <div id="fields">
                <label for="parentNameIn">Parent name:</label>
                <input id="parentNameIn" name="parentName-input" oninput="showClickable()" value="Parent name" type="text" />
                <br><br>
                <label for="parentSNIn">Parent SN:</label>
                <input id="parentSNIn" name="parentSN-input" oninput="showClickable()" value="Parent SN" type="text" />
                <br><br>
                <label for="childNameIn">Child name:</label>
                <input id="childNameIn" name="childName-input" oninput="showClickable()" value="Child name" type="text" />
                <br><br>
                <label for="childSNIn">Child SN:</label>
                <input id="childSNIn" name="childSN-input" oninput="showClickable()" value="Child SN" type="text" />
                <br><br>
                <label for="positionDetDU">Position (only when doing Detector -> DU):</label>
                <input id="positionDetDU" name="positionDetDU-input" oninput="showClickable()" value="VxLxQx" type="text" />
                <br><br>
                <label for="positionOut">Position (only when doing DU -> Module):</label>
                <output id="positionOut" name="position-output" style="background-color:#EEE"> Waiting for user input </output>
                <br><br>
                <button type="button" id="addBut">ADD PARTS TREE</button>
            </div>
            <div id="clickable">
                <canvas id="duCanvas" width=600 height=600></canvas>
            </div>
        </div>
        <p>Already stored relations:</p>
        <p>DU MODULE</p>
        <output id="relations_DU_MODULE">
        </output>
        <p>DETECTOR DU</p>
        <output id="relations_DETECTOR_DU">
        </output>
        <p>SLOT MODULE</p>
        <output id="relations_SLOT_MODULE">
        </output>
        <hr>
        <p>Use this input to specify a slot table csv.</p>
        <input type="file" id="csvFileInput" onchange="handleFiles(this.files)" accept=".csv"><br>
        <p>Known slots:</p>
        <output id="csvOut">
        </output>
    </div>
    <script src="script.js"></script>
  </body>
</html>
